{% liquid 
assign shipping_value = settings.freeshipping_value | times: 100
assign cart_total = cart.total_price
assign shippingValurPercentage = shipping_value | minus: cart_total | money_with_currency
assign progress_shipping = cart_total | times: 100 | divided_by: shipping_value
%}

<div class="free-shipping-progres-bar">
  <div class="free_shipping_progress">
    {% if cart_total >= shipping_value %}
      <div class="free_shipping">{{ 'templates.cart.free_shipping_text' | t }}</div>
    {% elsif cart_total <= shipping_value %}
      <div class="free_shipping_value">spend to <strong>{{ shippingValurPercentage }} </strong> reach free shipping!</div>
    {% endif %}
  </div>

  <div class="progress-bar-section {% if cart_total >= shipping_value %} progress_bar_active {% endif %}">
    <div class="progress-bar" data-progress="loading"><span></span></div>
  </div>

  {% if cart_total >= shipping_value %}
      <div class="sparkle">
        <div class="sparkle_chingles">
          <div class="bubble_line" style="--overall: 6">
            <div class="bubble_line_code" style="--color: 1;"></div>
            <div class="bubble_line_code" style="--color: 2;"></div>
            <div class="bubble_line_code" style="--color: 3;"></div>
            <div class="bubble_line_code" style="--color: 4;"></div>
            <div class="bubble_line_code" style="--color: 5;"></div>
            <div class="bubble_line_code" style="--color: 6;"></div>
          </div>
        </div>
      </div>    
  {% endif %}
</div>

<style>
{% if cart_total >= shipping_value %}
:root {
  --duration: 600ms;
}
.bubble_line {
    position: relative;
}
.sparkle_chingles {
  display: grid;
  -webkit-box-align: center;
  align-items: center;
  -webkit-box-pack: center;
  justify-content: center;
  z-index: 1;
}
.sparkle {
  font-size: 1.5vmin;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

.bubble_line_code {
    position: absolute;
    top: -35px;
    left: -30px;
    height: 3rem;
    width: .2rem;
    border-radius: 4rem;
    background-color: #37a900;
    --percentage: calc(var(--color) / var(--overall));
    --Θ: calc(var(--percentage) * 1turn);
    -webkit-transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0)
    scaleY(0);
    transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0) scaleY(0);
    -webkit-transition: all var(--duration) ease;
    transition: all var(--duration) ease;
}
.sparkle .bubble_line_code {
  -webkit-animation: bubble_line calc(var(--duration) * 1.2) ease
    forwards infinite;
  animation: bubble_line calc(var(--duration) * 1.2) ease forwards infinite;
}
@-webkit-keyframes bubble_line {
  50% {
    height: 0.3em;
  }
  50%,
  60% {
    height: 0.3em;
    -webkit-transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0.8em)
      scale(1);
    transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0.8em) scale(1);
  }
  60% {
    height: 0.2em;
  }
  100% {
    -webkit-transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(1em)
      scale(0);
    transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(1em) scale(0);
  }
}
@keyframes bubble_line {
  50% {
    height: 0.3em;
  }
  50%,
  60% {
    height: 0.3em;
    -webkit-transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0.8em)
      scale(1);
    transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(0.8em) scale(1);
  }
  60% {
    height: 0.2em;
  }
  100% {
    -webkit-transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(1em)
      scale(0);
    transform: translate(-50%, -50%) rotate(var(--Θ)) translateY(1em) scale(0);
  }
}
  .bubble_line .bubble_line_code {
    display: none;
}
{% endif %}
  .progress-bar-section {
    background-color: #F0F0F0;
    display: flex;
    height: 2px;
    width: 100%;
    position: relative;
    align-items: center;
}
  
  .progress-bar{
    display: flex;
    text-align: center;
    align-items: center;
    justify-content: center;
    height: 100%;
    background: linear-gradient(325deg, #3448ff, #f14d4d);
    transition: all var(--duration-default) linear;
    max-width: 100%;
    width: {{ progress_shipping }}%;
  }
  .free_shipping_value,
  .free_shipping{
    font-family: var(--font-body-family);
    text-transform: capitalize;
    color: rgba(var(--color-foreground), 1);
    line-height: calc(1 + 0.5 / var(--font-body-scale));
    font-weight: 500;
    letter-spacing: normal;
}
  .free_shipping_progress {
    margin-bottom: 1rem;
}
  .free_shipping {
    color: #37a900;
}
  .progress-bar-section.progress_bar_active .progress-bar{
    background: #37a900;
  }
  .free-shipping-progres-bar {
    margin-bottom: 10px;
  }
</style>