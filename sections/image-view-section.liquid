<style>
.image-view-section {
  padding: 50px 0;
}
.image-view-section .page-width{
  max-width: 120rem;
}

.ivs-title {
  text-align: center;
  margin-bottom: 30px;
}

.ivs-grid {
  display: grid;
  gap: 25px;
}

.columns-1 { grid-template-columns: 1fr; }
.columns-2 { grid-template-columns: repeat(2, 1fr); }
.columns-3 { grid-template-columns: repeat(3, 1fr); }
.columns-4 { grid-template-columns: repeat(4, 1fr); }


@media(max-width: 749px){
.columns-3 { grid-template-columns: repeat(2, 1fr); }
.columns-4 { grid-template-columns: repeat(2, 1fr); }
}

.ivs-item {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.ivs-top-img {
  width: 100%;
  border-radius: 10px;
  margin-bottom: 15px;
  display: block;
  max-width: 150px;
  height: auto
}

.ivs-view-btn {
  margin-top: 15px;
  padding: 12px 22px;
  border: none;
  background: #111;
  color: #fff;
  cursor: pointer;
  border-radius: 8px;
  transition: 0.3s;
}

.ivs-view-btn:hover {
  background: #333;
}

/* MODAL */
.ivs-modal {
  display: none;
  position: fixed;
  z-index: 99999;
  inset: 0;
  background: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.ivs-modal-content {
  width: 90%;
  height: auto;
  max-height: 90vh;
  max-width: 600px;
  border-radius: 10px;
  object-fit: contain;
}

@media (max-width: 749px) {
  .ivs-modal-content {
    width: 100%;
    max-width: 100%;
    height: auto;
    max-height: 90vh;
  }
}



.ivs-close {
  position: absolute;
  right: 30px;
  top: 20px;
  font-size: 45px;
  color: #fff;
  cursor: pointer;
  font-weight: bold;
}
 .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.50 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.50 | round: 0 }}px;
  }
   @media screen and (min-width: 576px) and (max-width: 749px){
   .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
   }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
</style>


<div class="image-view-section">
    <div class="page-width section-{{ section.id }}-padding isolate grid-banner-padding">
    
  {% if section.settings.section_title != blank %}
    <h2 class="title inline-richtext h1">
            {{ section.settings.section_title| escape }} <span>{{ section.settings.span_text }}</span>
     </h2>
  {% endif %}

  <div class="ivs-grid columns-{{ section.settings.columns }}">
    {% for block in section.blocks %}
    <div class="ivs-item">

      <!-- First Image (shown in layout) -->
      {% if block.settings.top_image != blank %}
        <img 
          src="{{ block.settings.top_image | image_url: width: 1200 }}"
          alt="{{ block.settings.top_image.alt | escape }}"
          class="ivs-top-img" width="100%" height="100%"
          loading="lazy"
        >
      {% endif %}

      {% if block.settings.title != blank %}
        <h3 class="ivs-item-title">{{ block.settings.title }}</h3>
      {% endif %}

      {% if block.settings.description != blank %}
        <p class="ivs-item-desc">{{ block.settings.description }}</p>
      {% endif %}

      {% if block.settings.button_text != blank %}
        <button class="ivs-view-btn" 
          data-image="{{ block.settings.popup_image | image_url: width: 2000 }}">
          {{ block.settings.button_text }}
        </button>
      {% endif %}

    </div>
    {% endfor %}
  </div>
</div>
</div>

<!-- MODAL -->
<div id="ivsModal" class="ivs-modal">
  <span class="ivs-close">&times;</span>
  <img id="ivsModalImg" class="ivs-modal-content" width="100%" height="100%">
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const modal = document.getElementById("ivsModal");
  const modalImg = document.getElementById("ivsModalImg");
  const closeBtn = document.querySelector(".ivs-close");

  document.querySelectorAll(".ivs-view-btn").forEach(btn => {
      btn.addEventListener("click", function() {
          const imgUrl = this.dataset.image;

          if(imgUrl !== '') {
            modal.style.display = "flex";
            modalImg.src = imgUrl;
          }
      });
  });

  closeBtn.onclick = function () {
    modal.style.display = "none";
    modalImg.src = "";
  };

  modal.onclick = function (e) {
    if (e.target === modal) {
      modal.style.display = "none";
      modalImg.src = "";
    }
  };
});
</script>

{% schema %}
{
  "name": "Image View Section",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Image View Section"
    },
    {
      "type": "range",
      "id": "columns",
      "label": "Columns",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    },
    {
    "type": "text",
    "id": "custom_class",
    "label": "t:sections.main-product.blocks.icon_with_text.settings.custom_class.label",
    "info": "t:sections.main-product.blocks.icon_with_text.settings.custom_class.info"
   },
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Image Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "top_image",
          "label": "Top Image (Displayed Above Title)"
        },
        {
          "type": "image_picker",
          "id": "popup_image",
          "label": "Popup Image (Opens in Modal)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Item Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Short description here."
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "View Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image View Section",
      "blocks": [
        { "type": "item" },
        { "type": "item" },
        { "type": "item" }
      ]
    }
  ]
}
{% endschema %}
